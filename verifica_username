<?php
// Connessione al database
$servername = "localhost:3306";
$username = "root";
$password = "";
$dbname = "SnakeDb";

try {
    $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch(PDOException $e) {
    echo "Errore di connessione al database: " . $e->getMessage();
    die();
}


$username = trim($_POST['username']);

// Esegui una query per verificare se lo username è già presente nel database
 
$stmt = $conn->prepare("SELECT COUNT(*) as count FROM utenti WHERE LOWER(username) = LOWER(:username)");
$stmt->execute(['username' => $username]);
$row = $stmt->fetch(PDO::FETCH_ASSOC);

if ($row['count'] > 0) {
    // Lo username è già presente nel database
    $response = array('available' => false);
} else {
    // Lo username è disponibile
    $response = array('available' => true);
}

echo json_encode($response);
?>
